<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>Wash Team Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Kanit', sans-serif; }
    .page { display: none; }
    .page.active { display: block; }
    .btn { transition: all .2s ease; }
    .btn:active { transform: scale(.95); }
  </style>
</head>

<body class="bg-slate-100 min-h-screen">

<!-- LOGIN -->
<div id="loginPage" class="page active flex items-center justify-center min-h-screen">
  <div class="bg-white p-6 rounded-2xl shadow w-full max-w-sm">
    <h1 class="text-xl font-bold text-center mb-4">üöø Wash Team Login</h1>
    <input id="username" class="w-full p-3 border rounded-xl mb-3" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">
    <input id="password" type="password" class="w-full p-3 border rounded-xl mb-4" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
    <button onclick="login()" class="btn w-full bg-blue-600 text-white py-3 rounded-xl font-semibold">
      ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
    </button>
    <p class="text-xs text-center text-slate-400 mt-3">
      demo: admin / 1234
    </p>
  </div>
</div>

<!-- APP -->
<div id="app" class="page">

<header class="bg-slate-900 text-white p-4">
  <h1 class="font-bold text-lg">WASH TEAM SYSTEM</h1>
  <p class="text-xs text-blue-300">Dashboard ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏ñ</p>
</header>

<nav class="flex text-sm bg-white border-b">
  <button onclick="go('daily')" class="flex-1 py-3">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</button>
  <button onclick="go('monthly')" class="flex-1 py-3">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</button>
</nav>

<main class="p-4 max-w-md mx-auto space-y-4">

<!-- DAILY -->
<section id="daily" class="page active space-y-4">

  <div class="bg-white p-4 rounded-xl shadow">
    <h2 class="font-semibold mb-3">üìÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h2>

    <input id="date" type="date" class="w-full p-3 border rounded-xl mb-3">

    <input id="cars" type="number" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ñ"
      class="w-full p-3 border rounded-xl mb-3">

    <input id="revenue" type="number" placeholder="‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö (‡∏ö‡∏≤‡∏ó)"
      class="w-full p-3 border rounded-xl mb-3">

    <input id="cost" type="number" placeholder="‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô (‡∏ö‡∏≤‡∏ó)"
      class="w-full p-3 border rounded-xl mb-4">

    <button onclick="saveDaily()" class="btn w-full bg-green-600 text-white py-3 rounded-xl">
      üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    </button>
  </div>

</section>

<!-- MONTHLY -->
<section id="monthly" class="page space-y-4">

  <div class="bg-white p-4 rounded-xl shadow">
    <h2 class="font-semibold mb-3">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h2>
    <canvas id="monthChart"></canvas>
  </div>

  <div class="bg-white p-4 rounded-xl shadow space-y-2">
    <h3 class="font-semibold">üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î</h3>
    <div id="summary"></div>

    <button onclick="copySummary()"
      class="btn w-full bg-blue-600 text-white py-3 rounded-xl mt-3">
      üì§ ‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏™‡πà‡∏á LINE
    </button>
  </div>

</section>

</main>
</div>

<script>
/* ---------- LOGIN ---------- */
function login() {
  const u = username.value;
  const p = password.value;
  if (u === "admin" && p === "1234") {
    loginPage.classList.remove("active");
    app.classList.add("active");
    loadMonthly();
  } else {
    alert("‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏¥‡∏î");
  }
}

/* ---------- NAV ---------- */
function go(page) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById(page).classList.add('active');
  if (page === "monthly") loadMonthly();
}

/* ---------- SAVE DAILY ---------- */
function saveDaily() {
  if (!date.value) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà");

  const data = JSON.parse(localStorage.getItem("washData")) || [];

  data.push({
    date: date.value,
    cars: +cars.value,
    revenue: +revenue.value,
    cost: +cost.value
  });

  localStorage.setItem("washData", JSON.stringify(data));
  alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
  cars.value = revenue.value = cost.value = "";
}

/* ---------- MONTHLY SUMMARY ---------- */
function loadMonthly() {
  const data = JSON.parse(localStorage.getItem("washData")) || [];
  const map = {};

  data.forEach(d => {
    const month = d.date.slice(0,7);
    if (!map[month]) map[month] = { rev:0, cost:0 };
    map[month].rev += d.revenue;
    map[month].cost += d.cost;
  });

  const labels = Object.keys(map);
  const profits = labels.map(m => map[m].rev - map[m].cost);

  document.getElementById("summary").innerHTML =
    labels.map(m => `
      <div class="flex justify-between">
        <span>${m}</span>
        <span class="font-bold">${profits[labels.indexOf(m)].toLocaleString()} ‡∏ö.</span>
      </div>
    `).join("");

  new Chart(document.getElementById("monthChart"), {
    type: "bar",
    data: {
      labels,
      datasets: [{
        label: "‡∏Å‡∏≥‡πÑ‡∏£",
        data: profits,
        backgroundColor: "#3b82f6"
      }]
    },
    options: {
      animation: { duration: 1200 }
    }
  });
}

/* ---------- COPY LINE ---------- */
function copySummary() {
  const text = document.getElementById("summary").innerText;
  navigator.clipboard.writeText("üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô\n" + text);
  alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß");
}
</script>

</body>
</html>
